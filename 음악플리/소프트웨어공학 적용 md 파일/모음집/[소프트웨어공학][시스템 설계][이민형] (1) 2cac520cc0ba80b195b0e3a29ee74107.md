# [소프트웨어공학][시스템 설계][이민형] (1)

# 개요

이 문서는 Genie2YT Playlist Converter 시스템의 구조와 설계에 대하여 기술하기 위해 작성되었다. 시스템은 사용자가 지니뮤직(Genie Music)의 재생목록 URL을 입력하면, 이를 파싱하고 YouTube Music 재생목록으로 자동 변환하는 기능을 제공한다. 서비스 특성상 외부 API 연동, URL 기반 파싱, 유사도 매칭 알고리즘, 재생목록 업로드, 변환 이력 관리 등 다양한 기능이 통합되어 있으며, 이를 유지보수성과 확장성이 높은 구조로 설계하는 것이 핵심 목표이다.

3계층 아키텍처를 기반으로 설계하며 필요한 하드웨어, 소프트웨어 구성요소를 함께 기술한다

# 1. 전체 시스템 구조 패키지 다이어그램

![image.png](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/image.png)

- **HCI 패키지**
    
    사용자 인터페이스, 화면 흐름, 입력/출력 기능을 담당하는 계층으로 React 기반 화면 구성 요소로 구성된다.
    
- **PD 패키지**
    
    재생목록 변환이라는 문제 영역(Problem Domain)의 핵심 로직을 포함한다.
    
    파서(Parser), 변환기(Converter), 매칭 엔진(MatchingEngine), 전략(Strategy), 어댑터(Adapter) 등이 포함된다.
    
- **DM 패키지**
    
    변환 기록, 사용자 정보, 로그 데이터를 다루는 계층이다.
    
    데이터베이스 스키마 및 CRUD 책임을 갖는 Repository로 구성된다.
    
- **External API 패키지**
    
    Google OAuth, YouTube Data API, Genie HTML 파싱 모듈 등 외부 서비스와 연결되는 모듈들로 구성된다.
    
- **Common 패키지(Utility/Logger)**
    
    공통적으로 사용되는 로깅, 오류 처리, 캐싱 기능을 제공한다.
    

# 2. 3계층 아키텍쳐 기반 DM과 HCI 계층 클래스

![3계층 아키텍처 구조도.png](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/3%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC_%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A5_%E1%84%80%E1%85%AE%E1%84%8C%E1%85%A9%E1%84%83%E1%85%A9.png)

### **2.1 HCI Layer (Human–Computer Interaction Layer)**

사용자 입력 처리 및 화면 출력 기능 중심.

- **LoginView**
    - **역할**: Google OAuth 로그인을 위한 진입 화면.
    - 책임: OAuth 로그인 버튼 제공 및 클릭 이벤트 처리, 사용자 인증 요청
    - 주요 기능: render(), requestLogin()
    - **입·출력**
        - 입력: 사용자의 로그인 요청(버튼 클릭)
        - 출력: 인증 완료 후 메인 화면(PlaylistInputView)로 전환
- **PlaylistInputView**
    - 책임: 재생목록 URL 입력
    - 기능: validateURL(), submitURL()
    - 입·출력
        - 입력: 사용자 입력 URL
        - 출력: 변환 요청 상태(성공/실패)에 따른 다음 화면 전환
- **ConversionStatusView**
    - 책임: 변환 진행 상태 표시
    - 기능: showProgress(), showError()
    - 입·출력
        - 입력: 서버에서 전달되는 진행 상황/오류 코드
        - 출력: 진행률, “잠시만 기다려 주세요”, “오류가 발생했습니다” 등의 메시지
- **ResultView**
    - 책임: 변환 완료 요약, 링크 표시
    - 기능: displayStats(), displayPlaylistURL()
- **HistoryView/ErrorLogView**
    - 책임: 변환 이력 조회, 오류 내용 표시
    - 기능: loadLogs(), displayLog()

### **2.2 PD Layer (Problem Domain Layer)**

재생목록 변환 로직 중심의 핵심 계층.

- **PlaylistConverter**
    - 책임: 전체 변환 절차 통제 (파싱 → 매칭 → 업로드)
    - 주요 기능: convert(), parseSongs(), matchSongs(), uploadSongs()
- **ParserFactory**
    - 책임: 플랫폼 유형에 따라 적절한 Parser 생성
    - 기능: createParser(platformType)
- **PlaylistParser (Interface)**
    - 책임: HTML/JSON 구조에서 곡 정보 추출
    - 기능: parse()
- **GenieParser / YouTubePlaylistReader**
    - 책임: 각 플랫폼 구조에 맞게 곡 정보 파싱
    - 기능: parse()
- **MatchingEngine**
    - 책임: 곡 정보 매칭 전략 실행
    - 기능: applyStrategy()
- **MatchStrategy (Interface)**
    - 책임: 매칭 알고리즘 표준화
    - 구현체:
        - TitleExactMatch
        - FuzzyMatch
        - KoreanNormalizeMatch
- **IPlaylistTargetAPI (Interface)**
    - 책임: 플랫폼별 재생목록 생성 규약 정의
    - 구현체:
        - YouTubeAdapter
        - SpotifyAdapter
- **YouTubeAPIClient / SpotifyAPIClient**
    - 책임: 실제 API 호출 수행
    - 기능: createPlaylist(), addItem()

### **2.3 DM Layer (Data Manipulation Layer)**

데이터 저장·조회·로그 기록 계층.

- **UserRepository**
    - **역할**: 사용자 계정 및 세션 관련 정보 저장/조회.
    - **책임**
        - 새로운 사용자 등록 (oauth 이메일 기준)
        - 사용자 ID로 조회
        - 토큰/세션 정보 업데이트
    - 기능: saveUser(), getUser()
- **ConvertLogRepository**
    - 역할: 재생목록 변환 이력 및 오류 로그 관리.
    - 주요 책임
        - 변환 요청이 끝난 후 성공/실패 통계를 로그로 저장
        - 특정 사용자 ID 기준 변환 이력 목록 조회
        - 실패 케이스만 모아 에러 로그 조회
    - 기능: saveLog(), getLogByUser(), getErrorLogs()
- **CacheRepository**
    - 역할: 동일 URL에 대한 중복 변환을 줄이기 위한 캐시 저장소.
    - 주요 책임
        - key(URL)로 변환 결과를 임시 저장
        - 캐시 조회 후 존재할 경우 재사용
    - 기능: getCache(), setCache()
- **DatabaseConnector**
    - 역할: SQLite/PostgreSQL 등 실제 DB와의 연결 관리.
    - 주요 책임
        - DB 연결 생성 및 해제
        - SQL 실행(SELECT/INSERT/UPDATE/DELETE)
        - 트랜잭션 처리(필요 시)
    - 기능: connect(), executeQuery()

# 3. 3계층 아키텍처 기반 DM계층 데이터베이스 스키마 설계

### **3.1 테이블 정의**

### **1) users**

| 컬럼 | 타입 | 설명 |
| --- | --- | --- |
| user_id | INTEGER PK | 사용자 고유 ID |
| email | TEXT | 사용자 이메일 |
| oauth_token | TEXT | Access Token |
| created_at | DATETIME | 가입일 |

### **2) convert_logs**

| 컬럼 | 타입 | 설명 |
| --- | --- | --- |
| log_id | INTEGER PK | 변환 이력 ID |
| user_id | INTEGER FK | users.user_id 참조 |
| src_playlist | TEXT | 원본 URL |
| dest_playlist | TEXT | 생성된 YouTube 재생목록 ID |
| success_count | INTEGER | 성공한 곡 수 |
| fail_count | INTEGER | 실패한 곡 수 |
| error_msg | TEXT | 오류 메시지 |
| created_at | DATETIME | 변환 날짜 |

### **3) api_logs**

| 컬럼 | 타입 | 설명 |
| --- | --- | --- |
| log_id | INTEGER PK | API 로그 ID |
| platform | TEXT | youtube/genie 등 |
| request | TEXT | 요청 내용 |
| response | TEXT | 응답 내용 |
| created_at | DATETIME | 요청 시간 |

### **3.2 관계(ER 모델 개요)**

- user 1 — N convert_logs
- convert_logs 1 — N playlist_items
- user 1 — N api_logs

![데이터베이스 ERD.png](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3_ERD.png)

# 4. 3계층 아키텍처를 기반 HCI 계층의 인터페이스 설계

![HCI  화면 전이도 ](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/HCI_%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%90%E1%85%A5%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%89%E1%85%B3%E1%84%92%E1%85%AA%E1%84%86%E1%85%A7%E1%86%AB_%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8B%E1%85%B5%E1%84%83%E1%85%A9.png)

HCI  화면 전이도 

### **4.1 주요 화면 구성**

- **Login Page**
    - OAuth 로그인 버튼
    - 인증 오류 시 메시지 표시
- **Playlist Input Page**
    - 재생목록 URL 입력 필드
    - 유효성 검사
    - “변환 시작” 버튼
- **Parsing / Conversion Progress Page**
    - 로딩 애니메이션
    - 진행률(%) 표시
    - 오류 발생 시 경고 표시
- **Result Page**
    - 성공/실패 개수
    - 처리 시간
    - 완성된 YouTube Playlist 링크 제공
    - 상세 로그 보기 버튼
- **History / Error Logs Page**
    - 지난 변환 기록 테이블
    - 오류 로그 테이블
    - CSV 다운로드 기능

# 5. 시스템 운영 물리적 아키텍처 정의

시스템은 클라이언트–서버 기반 구조이며 다음과 같은 물리적 구성 요소를 가진다.

![물리적 아키텍처.png](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/%E1%84%86%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%84%8C%E1%85%A5%E1%86%A8_%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A5.png)

### **5.1 실행 환경**

- **Client:** Chrome/Edge 등 웹 브라우저
- **Frontend Server:** React SPA(Vercel 또는 Netlify)
- **Backend Server:** Flask API 서버(Gabia Cloud or AWS EC2)
- **Database:** SQLite(개발), PostgreSQL(운영)
- **External Service:** Google OAuth, YouTube Data API, Genie HTML 서버

### **5.2 통신 구조**

- Client ↔ Backend: HTTPS, JSON REST API
- Backend ↔ YouTube API: HTTPS, OAuth 인증 기반
- Backend ↔ DB: SQL Query

# 6. 배치다이어그램

![배치 다이어그램.png](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/%E1%84%87%E1%85%A2%E1%84%8E%E1%85%B5_%E1%84%83%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%A5%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%86%B7.png)

- **Node 1: 사용자 브라우저(HCI 계층)**
    - React 앱 로드
    - API 요청: /login, /convert, /result
- **Node 2: Flask 백엔드(PD+DM 계층)**
    - 변환 로직 실행
    - Parser 사용
    - Matching Engine 호출
    - Repository를 통해 DB 접근
- **Node 3: Database 서버**
    - 사용자 정보 및 로그 저장
- **Node 4: 외부 API 노드**
    - Google OAuth 인증 처리
    - YouTube API 재생목록 생성/추가

# 7. 클래스의 변수와 메서드들에 대하여 세부 속성과 알고리즘을 정의

![시퀀스 다이어그램](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/%E1%84%89%E1%85%B5%E1%84%8F%E1%85%AF%E1%86%AB%E1%84%89%E1%85%B3_%E1%84%83%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%A5%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%86%B7.png)

시퀀스 다이어그램

![클래스 다이어그램](%5B%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B3%B5%ED%95%99%5D%5B%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%84%A4%EA%B3%84%5D%5B%EC%9D%B4%EB%AF%BC%ED%98%95%5D%20(1)/%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A2%E1%84%89%E1%85%B3_%E1%84%83%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%A5%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%86%B7_(PD__DM_%E1%84%8C%E1%85%AE%E1%86%BC%E1%84%89%E1%85%B5%E1%86%B7).png)

클래스 다이어그램

### **7.1 PlaylistConverter**

**속성**

- parser
- adapter
- matchEngine
- rawTracks
- matchedTracks

**메서드**

- convert(): 전체 변환 흐름 제어
- parseSongs(): rawTracks 생성
- matchSongs(): MatchingEngine 호출
- uploadSongs(): YouTubeAdapter 호출

### **7.2 MatchingEngine**

**속성**

- strategy: MatchStrategy

**메서드**

- applyStrategy(trackA, trackB)

**알고리즘 예**

- **FuzzyMatch:** Levenshtein Distance 계산 후 임계값 적용
- **KoreanNormalizeMatch:** 자모 분리 후 KS X 1001 매핑 기반 비교
- **TitleExactMatch:** 완전 일치 비교

### **7.3 YouTubeAdapter**

**속성**

- apiClient
- accessToken

**메서드**

- createPlaylist()
- addTrack(videoId)

### **7.4 GenieParser**

**속성**

- url
- html

**메서드**

- parse(): BeautifulSoup 활용하여 곡명/가수 리스트 추출

### **7.5 ConvertLogRepository**

**속성**

- dbConnector

**메서드**

- saveLog(log)
- getLogsByUser(userId)
- getErrorLogs()

# 8. 시스템이 운영될 하드웨어, 소프트웨어,통신구성요소에 대한 기술 스펙을 작성한다

### **8.1 소프트웨어 스펙**

- OS: macOS / Windows / Ubuntu
- Backend: Python 3.11 + Flask
- Frontend: React 18 + Vite
- DB: SQLite / PostgreSQL
- API: YouTube Data API v3, OAuth 2.0
- 개발도구: VSCode, Postman, GitHub
- 배포환경: Gabia Cloud or AWS EC2

### **8.2 하드웨어 스펙**

- 개발용:
    - CPU: Intel i5 이상 또는 Apple M1
    - RAM: 8GB 이상(권장 16GB)
    - 저장공간: 256GB 이상 SSD
- 서버:
    - CPU: 2 vCPU 이상
    - RAM: 4GB 이상
    - Storage: 20GB SSD

### **8.3 통신 구성**

- 모든 구간에서 HTTPS 의무 적용
- OAuth 인증 토큰은 메모리 기반 세션 관리
- CORS 정책 적용